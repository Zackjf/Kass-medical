---
import { getCollection } from "astro:content";
import Section from "../ui/Section.astro";
import Tag from "../ui/Tag.astro";

const experiences = (await getCollection("experience")).sort(
  (a, b) => a.data.order - b.data.order
);
---

<Section 
  id="experience" 
  title="Experience" 
  subtitle="Proven track record in medical billing and healthcare administration."
>
  <div class="relative">
    <!-- Timeline line -->
    <div class="absolute left-0 md:left-1/2 top-0 bottom-0 w-px bg-gradient-to-b from-primary-300 via-primary-200 to-transparent hidden md:block -translate-x-1/2"></div>

    <div class="space-y-8">
      {experiences.map((exp, index) => (
        <div 
          class={`relative animate-fade-in-up ${index % 2 === 0 ? 'md:pr-1/2' : 'md:pl-1/2 md:ml-auto'}`}
          style={`animation-delay: ${0.1 + index * 0.1}s`}
        >
          <!-- Timeline dot -->
          <div class="absolute left-0 md:left-1/2 top-6 w-4 h-4 rounded-full bg-primary-500 border-4 border-white shadow-md hidden md:block -translate-x-1/2"></div>

          <div class={`md:w-[calc(50%-2rem)] ${index % 2 === 0 ? '' : 'md:ml-auto'}`}>
            <div class="bg-white border border-neutral-200 rounded-2xl p-6 hover:border-primary-200 hover:shadow-lg transition-all duration-300">
              <!-- Header -->
              <div class="flex flex-wrap items-start justify-between gap-2 mb-4">
                <div>
                  <h3 class="font-display font-semibold text-lg text-neutral-900">
                    {exp.data.role}
                  </h3>
                  <p class="text-neutral-600">{exp.data.company}</p>
                </div>
                <div class="text-right">
                  <span class="inline-flex items-center gap-1.5 px-3 py-1 bg-primary-50 text-primary-700 text-sm font-medium rounded-full">
                    <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                    {exp.data.startDate} â€“ {exp.data.endDate ?? "Present"}
                  </span>
                </div>
              </div>

              <!-- Highlights -->
              <ul class="space-y-2 mb-4">
                {exp.data.highlights.map((highlight) => (
                  <li class="flex items-start gap-2 text-sm text-neutral-600">
                    <svg class="w-4 h-4 text-accent-500 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4" />
                    </svg>
                    {highlight}
                  </li>
                ))}
              </ul>

              <!-- Tools -->
              {exp.data.tools.length > 0 && (
                <div class="pt-4 border-t border-neutral-100">
                  <div class="flex flex-wrap gap-2">
                    {exp.data.tools.map((tool) => (
                      <Tag size="sm" variant="secondary">{tool}</Tag>
                    ))}
                  </div>
                </div>
              )}
            </div>
          </div>
        </div>
      ))}
    </div>
  </div>
</Section>

